<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8" />
  <title>‡∏´‡∏ô‡πâ‡∏≤‡πÅ‡∏£‡∏Å | Elder Care</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+Thai:wght@400;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="./home.css" />
</head>
<body>
  <div class="page">
    <div class="home-card">
      <div class="brand">
        <img src="./images/logo.png" alt="Elder Care" onerror="this.style.display='none'"/>
      </div>
      <h1 class="title" id="welcome">‡∏ú‡∏π‡πâ‡∏ä‡πà‡∏ß‡∏¢‡∏î‡∏π‡πÅ‡∏•‡∏ú‡∏π‡πâ‡∏™‡∏π‡∏á‡∏≠‡∏≤‡∏¢‡∏∏</h1>
      <p class="subtitle">‡∏¢‡∏¥‡∏ô‡∏î‡∏µ‡∏ï‡πâ‡∏≠‡∏ô‡∏£‡∏±‡∏ö‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö Elderly Care</p>

     <div class="menu">
  <a href="./schedule.html" class="btn btn-primary">üìÖ ‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏ô‡∏±‡∏î‡∏´‡∏°‡∏≤‡∏¢</a>
  <a href="./meds.html" class="btn btn-primary">üíä ‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏¢‡∏≤</a>
  <a href="./health.html" class="btn btn-primary">üìà ‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏™‡∏∏‡∏Ç‡∏†‡∏≤‡∏û</a>
  <a href="./alerts.html" class="btn btn-primary">üîî ‡∏Å‡∏≤‡∏£‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô</a>
    </div>


      <div class="footer">
        <button class="btn btn-secondary" onclick="logout()">‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡∏£‡∏∞‡∏ö‡∏ö</button>
      </div>
    </div>
  </div>

  <script>
    // ===== Auth guard: ‡πÑ‡∏°‡πà‡∏°‡∏µ token ‚Üí ‡∏Å‡∏•‡∏±‡∏ö‡∏´‡∏ô‡πâ‡∏≤ login
    const token = localStorage.getItem("token");
    if (!token) {
      window.location.href = "./login.html";
    }

    // ‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ï‡πâ‡∏≠‡∏ô‡∏£‡∏±‡∏ö (‡πÅ‡∏•‡∏∞‡∏ï‡∏£‡∏ß‡∏à token ‡∏´‡∏°‡∏î‡∏≠‡∏≤‡∏¢‡∏∏)
    async function loadMe(){
      try{
        const res = await fetch("./api/me", { headers: { Authorization: "Bearer " + token }});
        if(!res.ok) throw new Error("unauthorized");
        const { user } = await res.json();
        const name = user?.name || user?.email || "‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô";
        document.getElementById("welcome").textContent = "‡∏¢‡∏¥‡∏ô‡∏î‡∏µ‡∏ï‡πâ‡∏≠‡∏ô‡∏£‡∏±‡∏ö, " + name;
      }catch(e){
        localStorage.removeItem("token");
        window.location.href = "./login.html";
      }
    }
    loadMe();

    function logout(){
      localStorage.removeItem("token");
      window.location.href = "./login.html";
    }
  </script>
</body>
</html>
